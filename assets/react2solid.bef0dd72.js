var m=Object.defineProperty;var s=(e,n)=>m(e,"name",{value:n,configurable:!0});import{ts as i,Project as p}from"https://esm.sh/ts-morph@^14.0.0";const d=`__CALLFUNCTION__${Date.now()}`;function f(e,n=!1){const t=e.getText();e.rename(`${t}${d}`),n&&e.replaceWithText(t)}s(f,"renameGetterVarToCall");function u(e){const n=e.getImportDeclaration("react"),t=[];if(n){const o=n.getNamespaceImport();if(o)for(const r of o.findReferencesAsNodes()){const a=r.getFirstAncestorByKind(i.SyntaxKind.CallExpression);if(a){const c=a.getFirstDescendantByKind(i.SyntaxKind.PropertyAccessExpression)?.getLastChildByKind(i.SyntaxKind.Identifier);c&&t.push({methodName:c.getText(),node:a})}}}return t}s(u,"findReactCalls");function g(e){const n=e.getImportDeclarations(),t={};for(const o of n){const r=o.getModuleSpecifier().getLiteralText();if(!t[r])t[r]=o;else{const a=o.getNamedImports().map(l=>l.getText());for(const l of o.getNamedImports()){const c=l.getText();a.includes(c)||o.addNamedImport(c)}o.remove()}}}s(g,"groupImports");function x(e){const n=e.getImportDeclarations();for(const t of n)t.getModuleSpecifier().getLiteralText()==="react"&&t.remove()}s(x,"removeReactImports");function y(e){for(const n of e.getImportDeclarations()){const t=n.getModuleSpecifier();t.getLiteralText().startsWith("@mui/")&&t.setLiteralValue(t.getLiteralText().replace(/^@mui/,"@suid"))}}s(y,"renameMuiImports");function I(e){const n=e.getFirstAncestorByKind(i.SyntaxKind.VariableDeclaration);if(n){const o=n.getFirstDescendantByKind(i.SyntaxKind.ArrayBindingPattern);if(o){const a=o.getFirstDescendantByKind(i.SyntaxKind.BindingElement)?.getFirstDescendantByKind(i.SyntaxKind.Identifier);a&&f(a,!0)}}e.getFirstDescendantByKind(i.SyntaxKind.PropertyAccessExpression)?.replaceWithText("createSignal"),e.getSourceFile().addImportDeclaration({namedImports:["createSignal"],moduleSpecifier:"solid-js"})}s(I,"replaceReactUseState");function S(e){const n=u(e);for(const t of n)t.methodName==="useState"&&I(t.node);y(e),x(e),g(e)}s(S,"transformReactSource");function T(e){const n=new p({useInMemoryFileSystem:!0,compilerOptions:{strict:!0,target:i.ScriptTarget.ESNext,module:i.ModuleKind.ESNext,moduleResolution:i.ModuleResolutionKind.NodeNext,forceConsistentCasingInFileNames:!0,allowSyntheticDefaultImports:!0,esModuleInterop:!0,jsx:i.JsxEmit.Preserve}}),t={};for(const r in e)t[r]=n.createSourceFile(r,e[r]);const o={};for(const r in t){const a=t[r];S(t[r]),o[r]=a.getText().replaceAll(d,"()")}return o}s(T,"react2solid");export{T as default};
