var g=Object.defineProperty;var c=(e,n)=>g(e,"name",{value:n,configurable:!0});import{ts as s,Project as x}from"https://esm.sh/ts-morph@^14.0.0";function y(e){const n=e.getImportDeclaration("react"),t=[];if(n){const r=n.getNamespaceImport();if(r)for(const o of r.findReferencesAsNodes()){if(o.getFirstAncestorByKind(s.SyntaxKind.NamespaceImport))continue;const a=o.getFirstAncestorByKind(s.SyntaxKind.PropertyAccessExpression)?.getLastChildByKind(s.SyntaxKind.Identifier);a&&t.push({name:a.getText(),node:a})}}return t}c(y,"findReactObjects");function S(e){const n=e.getImportDeclarations(),t={};for(const r of n){const o=r.getModuleSpecifier().getLiteralText();if(!t[o])t[o]=r;else{const i=r.getNamedImports().map(a=>a.getText());for(const a of r.getNamedImports()){const l=a.getText();i.includes(l)||r.addNamedImport(l)}r.remove()}}}c(S,"groupImports");function I(e){const n=e.getImportDeclarations();for(const t of n)t.getModuleSpecifier().getLiteralText()==="react"&&t.remove()}c(I,"removeReactImports");function K(e){for(const n of e.getImportDeclarations()){const t=n.getModuleSpecifier();t.getLiteralText().startsWith("@mui/")&&t.setLiteralValue(t.getLiteralText().replace(/^@mui/,"@suid"))}}c(K,"renameMuiImports");function m(e,n,t){const r=e;r.__replacePatterns||(r.__replacePatterns={}),r.__replacePatterns[n]=t}c(m,"addReplacePattern");const d=`__EMPTY__${Date.now()}`;function F(e){const n=e.getFirstAncestorByKind(s.SyntaxKind.JsxElement);m(e.getSourceFile(),d,""),n?.set({name:d})}c(F,"replaceReactFragment");const p=`__CALLFUNCTION__${Date.now()}`;function T(e,n=!1){const t=e.getText();m(e.getSourceFile(),p,"()"),e.rename(`${t}${p}`),n&&e.replaceWithText(t)}c(T,"renameGetterVarToCall");function _(e){const n=e.getFirstAncestorByKind(s.SyntaxKind.CallExpression),t=n?.getFirstAncestorByKind(s.SyntaxKind.VariableDeclaration);if(t){const o=t.getFirstDescendantByKind(s.SyntaxKind.ArrayBindingPattern);if(o){const a=o.getFirstDescendantByKind(s.SyntaxKind.BindingElement)?.getFirstDescendantByKind(s.SyntaxKind.Identifier);a&&T(a,!0)}}n?.getFirstDescendantByKind(s.SyntaxKind.PropertyAccessExpression)?.replaceWithText("createSignal"),e.getSourceFile().addImportDeclaration({namedImports:["createSignal"],moduleSpecifier:"solid-js"})}c(_,"replaceReactUseState");function P(e){const n=y(e);for(const t of n)t.node.wasForgotten()||(t.name==="useState"?_(t.node):t.name==="Fragment"&&F(t.node));K(e),I(e),S(e)}c(P,"transformReactSource");function B(e){return e.__replacePatterns}c(B,"getReplacePatterns");function N(e){const n=new x({useInMemoryFileSystem:!0,compilerOptions:{strict:!0,target:s.ScriptTarget.ESNext,module:s.ModuleKind.ESNext,moduleResolution:s.ModuleResolutionKind.NodeNext,forceConsistentCasingInFileNames:!0,allowSyntheticDefaultImports:!0,esModuleInterop:!0,jsx:s.JsxEmit.Preserve}}),t={};for(const o in e)t[o]=n.createSourceFile(o,e[o]);const r={};for(const o in t){const i=t[o];P(t[o]);const a=B(i)||{};let l=i.getText();for(const[f,u]of Object.entries(a))l=l.replaceAll(f,u);r[o]=l}return r}c(N,"react2solid");export{N as default};
