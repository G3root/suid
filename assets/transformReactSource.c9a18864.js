var P=Object.defineProperty;var o=(e,n)=>P(e,"name",{value:n,configurable:!0});import{ts as s,Node as m}from"https://esm.sh/ts-morph@^14.0.0";import{v as B,a2 as R}from"./index.5b127efa.js";function $(e){return e.getDescendantsOfKind(s.SyntaxKind.ObjectBindingPattern)}o($,"findObjectBindingPatterns");function g(e){const n=e.getParentWhileKind(s.SyntaxKind.QualifiedName);if(n)return n;const t=e.getParentWhileKind(s.SyntaxKind.TypeReference);if(t)return t;const i=e.getParentWhileKind(s.SyntaxKind.PropertyAccessExpression);return i||e}o(g,"getParentExpr");function D(e,n){const t=e.getImportDeclaration("react"),i=[],a=o(r=>{const l=r.getText();(!n||n.includes(l))&&i.push({name:l,node:r})},"push");if(t){const r=t.getNamespaceImport(),l=t.getNamedImports();for(const d of l){const c=d.getFirstChildByKind(s.SyntaxKind.Identifier);if(c)for(const f of c.findReferencesAsNodes())f!==c&&m.isIdentifier(f)&&a(f)}if(r)for(const d of r.findReferencesAsNodes()){if(d.getFirstAncestorByKind(s.SyntaxKind.NamespaceImport))continue;const f=g(d)?.getLastChildByKind(s.SyntaxKind.Identifier);f&&a(f)}}return i}o(D,"findReactObjects");function h(e,n){e.includes(n)||e.push(n)}o(h,"add");function O(e){const n=e.getImportDeclarations(),t={};for(const i of n){const a=i.getModuleSpecifier().getLiteralText();t[a]||(t[a]={nodes:[],withoutFrom:!0,named:[],defaults:[],namespaces:[]}),t[a].nodes.push(i);for(const d of i.getNamedImports())t[a].withoutFrom=!1,h(t[a].named,d.getText());const r=i.getDefaultImport();r&&(t[a].withoutFrom=!1,h(t[a].defaults,r.getText()));const l=i.getNamespaceImport();l&&(t[a].withoutFrom=!1,h(t[a].namespaces,l.getText()))}for(const i in t){const a=t[i];a.withoutFrom&&e.addImportDeclaration({moduleSpecifier:i}),a.named.length&&e.addImportDeclaration({moduleSpecifier:i,namedImports:a.named});for(const r of a.defaults)e.addImportDeclaration({moduleSpecifier:i,defaultImport:r});for(const r of a.namespaces)e.addImportDeclaration({moduleSpecifier:i,namespaceImport:r});for(const r of a.nodes)r.remove()}}o(O,"groupImports");function N(e){const n=e.getImportDeclarations();for(const i of n)i.getModuleSpecifier().getLiteralText()==="prop-types"&&i.remove();const t=e.getChildrenOfKind(s.SyntaxKind.ExpressionStatement);for(const i of t)i.getFirstChildByKind(s.SyntaxKind.BinaryExpression)?.getFirstChildByKind(s.SyntaxKind.PropertyAccessExpression)?.getLastChildByKind(s.SyntaxKind.Identifier)?.getText()==="propTypes"&&i.remove()}o(N,"removePropTypes");function j(e){const n=e.getImportDeclarations();for(const t of n)t.getModuleSpecifier().getLiteralText()==="react"&&t.remove()}o(j,"removeReactImports");function v(e){for(const n of e.getImportDeclarations()){const t=n.getModuleSpecifier();t.getLiteralText().startsWith("@mui/")&&t.setLiteralValue(t.getLiteralText().replace(/^@mui/,"@suid"))}}o(v,"renameMuiImports");function C(e){let n=!1;return e.getParentWhile(t=>{if(m.isFunctionDeclaration(t)||m.isFunctionExpression(t)){const i=t.getBody()?.getChildrenOfKind(s.SyntaxKind.ReturnStatement);for(const a of i||[]){const r=a.getChildAtIndexIfKind(1,s.SyntaxKind.ParenthesizedExpression);return n=!!(r||a).getChildAtIndexIfKind(1,s.SyntaxKind.JsxFragment)||!!(r||a).getChildAtIndexIfKind(1,s.SyntaxKind.JsxElement),!1}}return!0}),n}o(C,"hasAncestorComponent");function x(e){if(m.isObjectLiteralExpression(e)||m.isArrayLiteralExpression(e)){for(const n of e.forEachChildAsArray())if(m.isPropertyAssignment(n)){const t=n.getInitializer();if(t&&!x(t))return!1}else if(!x(n))return!1;return!0}return m.isTrueLiteral(e)||m.isFalseLiteral(e)||m.isUndefinedKeyword(e)||m.isNullLiteral(e)||m.isNumericLiteral(e)||m.isStringLiteral(e)||m.isIdentifier(e)}o(x,"isStaticValue");function W(e){let n=!1;return e.getParentWhile(t=>m.isTypeAliasDeclaration(t)||m.isInterfaceDeclaration(t)||m.isTypeLiteral(t)?(n=!0,!1):!0),n}o(W,"hasAncestorType");function S(e,n,t=!0){for(const i of e.findReferencesAsNodes()){if(t&&e===i||W(i))continue;const a=i.getParent();m.isShorthandPropertyAssignment(a)?a.replaceWithText(`${e.getText()}: ${n}`):m.isIdentifier(i)&&i.replaceWithText(n)}}o(S,"renameIdentifiers");function b(e){const n=[];for(const t of e.getChildrenOfKind(s.SyntaxKind.BindingElement)){const i=!!t.getChildAtIndexIfKind(0,s.SyntaxKind.DotDotDotToken),a=t.getChildAtIndexIfKindOrThrow(i?1:0,s.SyntaxKind.Identifier),r={name:a.getText(),rest:i,identifier:a};n.push(r);const l=t.getFirstChildByKind(s.SyntaxKind.EqualsToken);l&&(r.defaults=t.getChildAtIndex(l.getChildIndex()+1));const d=t.getFirstChildByKind(s.SyntaxKind.ColonToken);if(d){const c=t.getChildAtIndex(d.getChildIndex()+1);m.isObjectBindingPattern(c)?r.destruct=b(c):m.isIdentifier(c)&&(r.rename=c)}}return n}o(b,"toJson");function y(e,n=!0){return e.endsWith("?")&&(e=e.slice(0,-1)+" || {}"),n&&e.includes(".")&&(n&&(e=`() => ${e}`),n==="withMergeProps"&&(e=`mergeProps(${e})`)),e}o(y,"safePropName");function V(e,n){const t=[],i=[],a=n.find(c=>c.rest);if(a){const c=a.name,f=JSON.stringify(n.filter(E=>!E.rest).map(E=>E.name));i.push("splitProps"),t.push(`const [, ${c}] = splitProps(${y(e,"withMergeProps")}, ${f});`),S(a.identifier,c)}const r=n.filter(c=>c.defaults&&!c.destruct);if(r.length){const c=`base${B(e)}`.replaceAll(".","_").replaceAll("?",""),E=`{
${r.reduce((u,T)=>(T.defaults&&x(T.defaults)?u+=`${T.name}: ${T.defaults?.getText()},
`:u+=`get ${T.name}() { return ${T.defaults?.getText()}; }
`,u),"")}}`;i.push("mergeProps"),t.push(`const ${c} = mergeProps(${E}, ${y(e)});
`);for(const u of r)S(u.rename||u.identifier,`${c}.${u.identifier.getText()}`)}const l=n.filter(c=>c.destruct);if(l.length)for(const c of l){const f=c.defaults?.getText().trim().startsWith("{"),E=V(`${e}.${c.name}${f?"?":""}`,c.destruct);i.push(...E.solidNamedImports.filter(u=>!i.includes(u))),t.push(...E.sentences)}const d=n.filter(c=>!c.rest&&!c.destruct&&!c.defaults);for(const c of d)S(c.rename||c.identifier,`${e}.${c.identifier.getText()}`);return{sentences:t,solidNamedImports:i}}o(V,"generateSentences");function w(e,n=!0){if(e.wasForgotten()||n&&!C(e))return;const t=e.getParent();let i;const a=b(e);if(m.isParameterDeclaration(t)){const l=(t.getParentIfKind(s.SyntaxKind.FunctionExpression)||t.getParentIfKind(s.SyntaxKind.FunctionDeclaration)||t.getParentIfKind(s.SyntaxKind.ArrowFunction))?.getParameters(),d=l?.indexOf(t);i=l?.length===1?"params":`params_${d}`}else if(t.getKind()===s.SyntaxKind.VariableDeclaration){const r=t.getChildAtIndex(2);if(r.getKind()===s.SyntaxKind.Identifier)i=r.getText();else return}else return;if(t.getKind()===s.SyntaxKind.Parameter){for(const r of a)S(r.rename||r.identifier,`${i}.${r.identifier.getText()}`);t.replaceWithText(i)}else if(t.getKind()===s.SyntaxKind.VariableDeclaration){const{sentences:r,solidNamedImports:l}=V(i,a);l.length&&t.getSourceFile().addImportDeclaration({moduleSpecifier:"solid-js",namedImports:l}),t.getFirstAncestorByKind(s.SyntaxKind.VariableStatement)?.replaceWithText(r.join(`

`))}}o(w,"replaceObjectBinding");function p(e,n,t){const i=g(e);t?("namespaceImport"in t?i.replaceWithText(`${t.namespaceImport}.${n}`):"namespaceNamedImport"in t?i.replaceWithText(`${t.namespaceNamedImport}.${n}`):"namedImport"in t&&i.replaceWithText(`${n}`),e.getSourceFile().addImportDeclaration({moduleSpecifier:t.moduleSpecifier,..."namespaceImport"in t&&{namespaceImport:t.namespaceImport},..."namespaceNamedImport"in t&&{namespaceImport:t.namespaceNamedImport},..."namedImport"in t&&{namedImports:[t.namedImport]}})):i.replaceWithText(n)}o(p,"renameExpr");function k(e){p(e,"Context",{moduleSpecifier:"solid-js",namedImport:"Context"})}o(k,"replaceReactContext");function _(e){p(e,"createContext",{moduleSpecifier:"solid-js",namedImport:"createContext"})}o(_,"replaceReactCreateContext");function J(e){const n=g(e).getParentIfKind(s.SyntaxKind.TypeReference);n&&n.getChildren().length>1?p(e,"Component",{moduleSpecifier:"solid-js",namedImport:"Component"}):p(e,"ElementType",{moduleSpecifier:"@suid/types",namespaceImport:"ST"})}o(J,"replaceReactElementType");function U(e){const n=e.getText();p(e,n,{moduleSpecifier:"@suid/types",namespaceImport:"ST"})}o(U,"replaceReactEventHandlers");function z(e){const n=e.getText();n==="ChangeEvent"?p(e,n,{moduleSpecifier:"@suid/types",namespaceImport:"ST"}):p(e,n)}o(z,"replaceReactEvents");function M(e,n,t){const i=e;i.__replacePatterns||(i.__replacePatterns={}),i.__replacePatterns[n]=t}o(M,"addReplacePattern");const H=`__EMPTY__${Date.now()}`;function q(e){const n=e.getFirstAncestorByKind(s.SyntaxKind.JsxElement);M(e.getSourceFile(),H,""),n?.set({name:H})}o(q,"replaceReactFragment");const{factory:L}=s,I={a:"HTMLAnchorElement",abbr:"HTMLElement",address:"HTMLElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",embed:"HTMLEmbedElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",footer:"HTMLElement",form:"HTMLFormElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",kbd:"HTMLElement",keygen:"HTMLElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",main:"HTMLElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLElement",menuitem:"HTMLElement",meta:"HTMLMetaElement",meter:"HTMLElement",nav:"HTMLElement",noindex:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLElement",p:"HTMLParagraphElement",param:"HTMLParamElement",picture:"HTMLElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",rp:"HTMLElement",rt:"HTMLElement",ruby:"HTMLElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",u:"HTMLElement",ul:"HTMLUListElement",var:"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement",svg:"SVGSVGElement",animate:"SVGAnimateElement",animateMotion:"SVGAnimateMotionElement",animateTransform:"SVGAnimateTransformElement",circle:"SVGCircleElement",clipPath:"SVGClipPathElement",defs:"SVGDefsElement",desc:"SVGDescElement",ellipse:"SVGEllipseElement",feBlend:"SVGFEBlendElement",feColorMatrix:"SVGFEColorMatrixElement",feComponentTransfer:"SVGFEComponentTransferElement",feComposite:"SVGFECompositeElement",feConvolveMatrix:"SVGFEConvolveMatrixElement",feDiffuseLighting:"SVGFEDiffuseLightingElement",feDisplacementMap:"SVGFEDisplacementMapElement",feDistantLight:"SVGFEDistantLightElement",feFlood:"SVGFEFloodElement",feFuncA:"SVGFEFuncAElement",feFuncB:"SVGFEFuncBElement",feFuncG:"SVGFEFuncGElement",feFuncR:"SVGFEFuncRElement",feGaussianBlur:"SVGFEGaussianBlurElement",feImage:"SVGFEImageElement",feMerge:"SVGFEMergeElement",feMergeNode:"SVGFEMergeNodeElement",feMorphology:"SVGFEMorphologyElement",feOffset:"SVGFEOffsetElement",fePointLight:"SVGFEPointLightElement",feSpecularLighting:"SVGFESpecularLightingElement",feSpotLight:"SVGFESpotLightElement",feTile:"SVGFETileElement",feTurbulence:"SVGFETurbulenceElement",filter:"SVGFilterElement",foreignObject:"SVGForeignObjectElement",g:"SVGGElement",image:"SVGImageElement",line:"SVGLineElement",linearGradient:"SVGLinearGradientElement",marker:"SVGMarkerElement",mask:"SVGMaskElement",metadata:"SVGMetadataElement",path:"SVGPathElement",pattern:"SVGPatternElement",polygon:"SVGPolygonElement",polyline:"SVGPolylineElement",radialGradient:"SVGRadialGradientElement",rect:"SVGRectElement",stop:"SVGStopElement",switch:"SVGSwitchElement",symbol:"SVGSymbolElement",text:"SVGTextElement",textPath:"SVGTextPathElement",tspan:"SVGTSpanElement",use:"SVGUseElement",view:"SVGViewElement"};function X(e){for(const n in I)if(I[n]===e)return n}o(X,"findTag");function Q(e){const n=g(e),i=n?.getParentIfKind(s.SyntaxKind.TypeReference)?.getLastChildByKind(s.SyntaxKind.TypeReference);if(i){const a=i.getLastChildByKind(s.SyntaxKind.Identifier)?.getText(),r=a?X(a):null;if(r)i.transform(()=>L.createLiteralTypeNode(L.createStringLiteral(r)));else{const l=R(e.getText().replace(/HTMLAttributes$/,""));l.length&&i.transform(()=>L.createLiteralTypeNode(L.createStringLiteral(l)))}n?.replaceWithText("ST.PropsOf"),e.getSourceFile().addImportDeclaration({namespaceImport:"ST",moduleSpecifier:"@suid/types"})}}o(Q,"replaceReactHTMLAttributes");const K=`__REMOVE__${Date.now()}`;function Y(e){const n=g(e),t=n.getParentIfKind(s.SyntaxKind.CallExpression);if(t){const i=t.getArguments();for(let a=1;a<i.length;++a)t.removeArgument(1);M(e.getSourceFile(),K,""),n.replaceWithText(K)}}o(Y,"replaceReactMemo");function Z(e){p(e,"JSXElement",{moduleSpecifier:"solid-js",namespaceNamedImport:"JSX"})}o(Z,"replaceReactNode");function ee(e){p(e,"Ref",{moduleSpecifier:"@suid/types",namespaceImport:"ST"})}o(ee,"replaceReactRef");const F=`__REMOVE__${Date.now()}`;function te(e){const n=g(e),t=n.getParentIfKind(s.SyntaxKind.CallExpression);if(t){const i=t.getArguments();for(let a=1;a<i.length;++a)t.removeArgument(1);M(e.getSourceFile(),F,""),n.replaceWithText(F)}}o(te,"replaceReactUseCallback");function ne(e){p(e,"useContext",{moduleSpecifier:"solid-js",namedImport:"useContext"})}o(ne,"replaceReactUseContext");function ie(e){const n=g(e),t=n.getParentIfKind(s.SyntaxKind.CallExpression);let i="createEffect",a=!1,r;if(t){const[l,d]=t.getArguments();r=(t.getFirstChildByKind(s.SyntaxKind.ArrowFunction)||t.getFirstChildByKind(s.SyntaxKind.FunctionExpression))?.getFirstChildByKind(s.SyntaxKind.Block)?.getChildSyntaxList()?.getFirstChildIfKind(s.SyntaxKind.ReturnStatement);let c="";(m.isFunctionExpression(l)||m.isArrowFunction(l))&&(c=l.getReturnType().getText()),a=c.startsWith("() =>")||c.startsWith("function"),m.isArrayLiteralExpression(d)&&!d.getElements().length&&(i="onMount"),d&&t.removeArgument(d)}if(a){if(i==="onMount"&&r){i="onCleanup";const l=(r.getFirstChildByKind(s.SyntaxKind.ArrowFunction)||r.getFirstChildByKindOrThrow(s.SyntaxKind.FunctionExpression)).getFirstChildByKindOrThrow(s.SyntaxKind.Block).getChildSyntaxListOrThrow();r.replaceWithText(l.getText())}else i+="WithCleaning";n.replaceWithText(i),e.getSourceFile().addImportDeclaration({namedImports:[i],moduleSpecifier:"@suid/system"})}else n.replaceWithText(i),e.getSourceFile().addImportDeclaration({namedImports:[i],moduleSpecifier:"solid-js"})}o(ie,"replaceReactUseEffect");function G(e,n=!1){const t=e.getText();S(e,`${t}()`),n&&e.replaceWithText(t)}o(G,"renameGetterVarToCall");function re(e){const n=g(e),t=n.getFirstAncestorByKind(s.SyntaxKind.CallExpression);if(t){const i=t.getFirstAncestorByKind(s.SyntaxKind.VariableDeclaration);if(i){const r=i.getFirstChildByKind(s.SyntaxKind.Identifier);r&&G(r,!0)}t.getArguments().length>1&&t.removeArgument(1)}n.replaceWithText("createMemo"),e.getSourceFile().addImportDeclaration({namedImports:["createMemo"],moduleSpecifier:"solid-js"})}o(re,"replaceReactUseMemo");function ae(e){const n=g(e),i=n.getFirstAncestorByKind(s.SyntaxKind.CallExpression)?.getFirstAncestorByKind(s.SyntaxKind.VariableDeclaration);if(i){const a=i.getFirstDescendantByKind(s.SyntaxKind.ArrayBindingPattern);if(a){const l=a.getFirstDescendantByKind(s.SyntaxKind.BindingElement)?.getFirstDescendantByKind(s.SyntaxKind.Identifier);l&&G(l,!0)}}n.replaceWithText("createSignal"),e.getSourceFile().addImportDeclaration({namedImports:["createSignal"],moduleSpecifier:"solid-js"})}o(ae,"replaceReactUseState");function A(e){if(e.wasForgotten())return"";const n=[];let t=[];const i=o(()=>{t.length&&n.push(`{ ${t.join(`,
`)}}`),t=[]},"drainProperties");for(const r of e.forEachChildAsArray())if(m.isSpreadAssignment(r)){i();const l=r.getChildAtIndex(1);x(l)?n.push(l.getText()):n.push(`() => ${l.getText()}`)}else if(m.isPropertyAssignment(r)){const l=r.getInitializer();let d;m.isObjectLiteralExpression(l)?d=A(l):d=l?.getText()??"undefined",l&&x(l)?t.push(`${r.getName()}: ${d}`):t.push(`get ${r.getName()}() { return ${d} }`)}else if(m.isShorthandPropertyAssignment(r)){const l=r.getName();t.push(`${l}: ${l}`)}else t.push(r.getText());const a=!!n.length;return i(),a?`mergeProps(${n.join(", ")})`:n[0]??"{}"}o(A,"getSpreadAsignment");function se(e){e.wasForgotten()||!C(e)||e.replaceWithText(A(e))}o(se,"replaceSpreadAsignment");const le={Fragment:q,Context:k,createContext:_,ElementType:J,memo:Y,ReactNode:Z,Ref:ee,useCallback:te,useContext:ne,useState:ae,useMemo:re,useEffect:ie};function de(e){const n=D(e);for(const t of n){if(t.node.wasForgotten())continue;let i=le[t.name];i||(t.name.endsWith("EventHandler")?i=U:t.name.endsWith("Event")?i=z:t.name.endsWith("HTMLAttributes")&&(i=Q)),i?.(t.node)}v(e),j(e),N(e),$(e).forEach(t=>w(t)),e.getDescendantsOfKind(s.SyntaxKind.ObjectLiteralExpression).forEach(se),O(e)}o(de,"transformReactSource");export{de as default};
